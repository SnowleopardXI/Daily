{\rtf1\ansi\ansicpg1252\cocoartf2709
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fnil\fcharset134 PingFangSC-Regular;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww28000\viewh17520\viewkind0
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\fs24 \cf0 *filter\
-A INPUT -i lo -j ACCEPT\
-A OUTPUT -o lo -j ACCEPT\

\f1 # 
\f0 Allow established and related\
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\
-A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\
# Allows all outbound traffic\
# -A OUTPUT - j ACCEPT\
# Allow ssh:22 http:80 https:443 ftp:21(20000-20500)\
-A INPUT -m state --state NEW -p tcp --dport 22 -j ACCEPT\
-A INPUT -m state --state NEW -p tcp --dport 80 -j ACCEPT\
-A INPUT -m state --state NEW -p tcp --dport 443 -j ACCEPT\
# -A INPUT -m state --state NEW -p tcp -m multiport --dports 21,20000:20500 -j ACCEPT\
# -A INPUT -p tcp -s 0/0 --sport 20000:20500 --dport 21 -m state --state NEW, ESTABLISHED -j ACCEPT\
\
# Allow DNS\
-A OUTPUT -p udp -d 114.114.114.114 --dport 53 -j ACCEPT\
-A OUTPUT -p udp -d 180.76.76.76 --dport 53 -j ACCEPT\
# -A OUTPUT -p udp --dport 123 -j ACCEPT\
# Allow ping\
-A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT\
# Log rejected (log-level=7) freq: 5 per minute, using dmesg or syslog\
# -A INPUT -m limit - limit 5/min -j LOG --log-prefix "iptables denied: " --log-level=7\
# Reject other policies\
-A OUTPUT -p udp -j REJECT --reject-with icmp-port-unreachable\
-A INPUT -j REJECT --reject-with icmp-port-unreachable\
-A FORWARD -j REJECT --reject-with icmp-port-unreachable\
COMMIT\
}